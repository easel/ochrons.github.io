<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/sjs2/assets/img/scala-js-logo-32.png">

    <title>Scala.js - From ES6 to Scala: Advanced</title>

    <!-- Bootstrap core CSS -->
    <link href="/sjs2/assets/css/bootstrap.css" rel="stylesheet">
    <link href="/sjs2/assets/css/highlight.css" type="text/css" rel="stylesheet" media="screen,projection"/>

    <!-- Custom styles for this template -->
    <link href="/sjs2/assets/css/style.css" rel="stylesheet">
    <link href="/sjs2/assets/css/font-awesome.min.css" rel="stylesheet">
    
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/sjs2/">Scala.js</a>
    </div>
    <div class="navbar-collapse collapse navbar-right">
      <ul class="nav navbar-nav">
        <li class="active"><a href="/sjs2/doc">DOCUMENTATION</a></li>
        <li ><a href="/sjs2/tutorial">TUTORIALS</a></li>
        <li ><a href="/sjs2/community">COMMUNITY</a></li>
        <li ><a href="/sjs2/news">NEWS</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</div>
<div id="wrap">
<div id="main">
<div id="blue">
    <div class="container">
        <div class="row">
            <h3>From ES6 to Scala: Advanced</h3>
        </div><!-- /row -->
    </div> <!-- /container -->
</div><!-- /blue -->

<div class="container mtb">
    <div class="row">
        <div class="col-md-9">
            <p>Scala is a feature rich language that is easy to learn but takes time to master. Depending on your programming
background, typically you start by writing Scala as you would’ve written the language you know best (JavaScript, Java or
C# for example) and gradually learn more and more idiomatic Scala paradigms to use. In this section we cover some of the
more useful design patterns and features, to get you started quickly.</p>

<h2 id="pattern-matching">Pattern matching</h2>

<p>In the Basics part we already saw simple examples of <em>pattern matching</em> as a replacement for JavaScript switch
statement. However, it can be used for much more, for example checking the type of input.</p>

<div class="row">
<div class="col-md-6"><h6 class="code-block-header">ES6</h6><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">printType</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="s2">&quot;string&quot;</span><span class="o">:</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="err">`</span><span class="nx">It</span><span class="s1">&#39;s a string: ${o}`); </span>
<span class="s1">      break;</span>
<span class="s1">    case &quot;number&quot;:</span>
<span class="s1">      console.log(`It&#39;</span><span class="nx">s</span> <span class="nx">a</span> <span class="nx">number</span><span class="o">:</span> <span class="nx">$</span><span class="p">{</span><span class="nx">o</span><span class="p">}</span><span class="err">`</span><span class="p">);</span> 
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;boolean&quot;</span><span class="o">:</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="err">`</span><span class="nx">It</span><span class="s1">&#39;s a boolean: ${o}`); </span>
<span class="s1">      break;</span>
<span class="s1">    default:</span>
<span class="s1">      console.log(`It&#39;</span><span class="nx">s</span> <span class="nx">something</span> <span class="k">else</span><span class="err">`</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>
</div>
        
<div class="col-md-6"><h6 class="code-block-header">Scala</h6><div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">printType</span><span class="o">(</span><span class="n">o</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">o</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">s</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=&gt;</span>
      <span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;It&#39;s a string: $s&quot;</span><span class="o">)</span>
    <span class="k">case</span> <span class="n">i</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span>
      <span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;It&#39;s an int: $i&quot;</span><span class="o">)</span>
    <span class="k">case</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=&gt;</span>
      <span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;It&#39;s a boolean: $b&quot;</span><span class="o">)</span>
    <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span>
      <span class="n">println</span><span class="o">(</span><span class="s">&quot;It&#39;s something else&quot;</span><span class="o">)</span>
<span class="o">}</span></code></pre></div>
</div>
</div>

<p>Pattern matching uses something called <em>partial functions</em> which means it can be used in place of regular functions, for
example in a call to <code>filter</code> or <code>map</code>. You can also add a <em>guard clause</em> in the form of an <code>if</code>, to limit the match. If
you need to match to a variable, use backticks to indicate that.</p>

<div class="row">
<div class="col-md-6"><h6 class="code-block-header">ES6</h6><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">parse</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">magicKey</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">c</span> <span class="nx">of</span> <span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">c</span> <span class="o">===</span> <span class="nx">magicKey</span><span class="p">)</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;magic&quot;</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/\d/</span><span class="p">))</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;digit&quot;</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/\w/</span><span class="p">))</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;letter&quot;</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/\s/</span><span class="p">))</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span>
    <span class="k">else</span> 
      <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;char&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="kr">const</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">parse</span><span class="p">(</span><span class="s2">&quot;JB/007&quot;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>
<span class="c1">// [letter, letter, magic, digit, digit, digit]</span></code></pre></div>
</div>
        
<div class="col-md-6"><h6 class="code-block-header">Scala</h6><div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">parse</span><span class="o">(</span><span class="n">str</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">magicKey</span><span class="k">:</span> <span class="kt">Char</span><span class="o">)</span><span class="k">=</span> <span class="o">{</span>
  <span class="n">str</span><span class="o">.</span><span class="n">map</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">c</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">magicKey</span> <span class="k">=&gt;</span>
      <span class="s">&quot;magic&quot;</span>
    <span class="k">case</span> <span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isDigit</span> <span class="k">=&gt;</span>
      <span class="s">&quot;digit&quot;</span>
    <span class="k">case</span> <span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isLetter</span> <span class="k">=&gt;</span>
      <span class="s">&quot;letter&quot;</span>
    <span class="k">case</span> <span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isWhitespace</span> <span class="k">=&gt;</span>
      <span class="s">&quot; &quot;</span>
    <span class="k">case</span> <span class="n">c</span> <span class="k">=&gt;</span>
      <span class="s">&quot;char&quot;</span>
  <span class="o">}</span>
<span class="o">}</span>
<span class="k">val</span> <span class="n">r</span> <span class="k">=</span> <span class="n">parse</span><span class="o">(</span><span class="s">&quot;JB/007&quot;</span><span class="o">,</span> <span class="sc">&#39;/&#39;</span><span class="o">)</span>
<span class="c1">// Seq(letter, letter, magic, digit, digit, digit)</span></code></pre></div>
</div>
</div>

<h4 id="destructuring">Destructuring</h4>

<p>Where pattern matching really shines is at destructuring. This means matching to a more complex pattern and extracting
values inside that structure. ES6 also supports destructuring (yay!) in assignments and function parameters, but not
in matching.</p>

<div class="row">
<div class="col-md-6"><h6 class="code-block-header">ES6</h6><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span><span class="nx">first</span><span class="o">:</span> <span class="s2">&quot;James&quot;</span><span class="p">,</span> <span class="nx">last</span><span class="o">:</span> <span class="s2">&quot;Bond&quot;</span><span class="p">,</span> 
  <span class="nx">age</span><span class="o">:</span> <span class="mi">42</span><span class="p">};</span>
<span class="kr">const</span> <span class="p">{</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="nx">years</span><span class="p">}</span> <span class="o">=</span> <span class="nx">person</span><span class="p">;</span>
<span class="c1">// first = &quot;James&quot;, last = &quot;Bond&quot;, years = 42</span>
<span class="kr">const</span> <span class="nx">seq</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">];</span>
<span class="kr">const</span> <span class="p">[</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="p">,</span> <span class="p">...</span><span class="nx">c</span><span class="p">]</span> <span class="o">=</span> <span class="nx">seq</span><span class="p">;</span>
<span class="c1">// a = 1, b = 2, c = [4, 5]</span>

<span class="kr">const</span> <span class="nx">seq2</span> <span class="o">=</span> <span class="p">[</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span> <span class="c1">// [1, 2, 4, 5]</span></code></pre></div>
</div>
        
<div class="col-md-6"><h6 class="code-block-header">Scala</h6><div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">case</span> <span class="k">class</span> <span class="nc">Person</span><span class="o">(</span><span class="n">first</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">last</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> 
  <span class="n">age</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>
<span class="k">val</span> <span class="n">person</span> <span class="k">=</span> <span class="nc">Person</span><span class="o">(</span><span class="s">&quot;James&quot;</span><span class="o">,</span> <span class="s">&quot;Bond&quot;</span><span class="o">,</span> <span class="mi">42</span><span class="o">)</span>
<span class="k">val</span> <span class="nc">Person</span><span class="o">(</span><span class="n">first</span><span class="o">,</span> <span class="n">last</span><span class="o">,</span> <span class="n">years</span><span class="o">)</span> <span class="k">=</span> <span class="n">person</span>
<span class="c1">// first = &quot;James&quot;, last = &quot;Bond&quot;, years = 42</span>
<span class="k">val</span> <span class="n">seq</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
<span class="k">val</span> <span class="nc">Seq</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="k">_</span><span class="o">,</span> <span class="n">c</span> <span class="k">@</span> <span class="k">_</span><span class="o">*)</span> <span class="k">=</span> <span class="n">seq</span> 
<span class="c1">// a = 1, b = 2, c = Seq(4, 5)</span>

<span class="k">val</span> <span class="n">seq2</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">++</span> <span class="n">c</span> <span class="c1">// Seq(1, 2, 4, 5)</span></code></pre></div>
</div>
</div>

<p>In Scala the destructuring and rebuilding have nice symmetry making it easy to remember how to do it. Use <code>_</code> to skip
values in destructuring.</p>

<p>In pattern matching the use of destructuring results in clean, simple and understandable code.</p>

<div class="row">
<div class="col-md-6"><h6 class="code-block-header">ES6</h6><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">ageSum</span><span class="p">(</span><span class="nx">persons</span><span class="p">,</span> <span class="nx">family</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">persons</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">p</span> <span class="o">=&gt;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">last</span> <span class="o">===</span> <span class="nx">family</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span> <span class="nx">p</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">age</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
<span class="kr">const</span> <span class="nx">persons</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span><span class="nx">first</span><span class="o">:</span> <span class="s2">&quot;James&quot;</span><span class="p">,</span> <span class="nx">last</span><span class="o">:</span> <span class="s2">&quot;Bond&quot;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">42</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">first</span><span class="o">:</span> <span class="s2">&quot;Hillary&quot;</span><span class="p">,</span> <span class="nx">last</span><span class="o">:</span> <span class="s2">&quot;Bond&quot;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">35</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">first</span><span class="o">:</span> <span class="s2">&quot;James&quot;</span><span class="p">,</span> <span class="nx">last</span><span class="o">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">55</span><span class="p">}</span>
<span class="p">];</span>

<span class="nx">ageSum</span><span class="p">(</span><span class="nx">persons</span><span class="p">,</span> <span class="s2">&quot;Bond&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">77</span><span class="p">;</span></code></pre></div>
</div>
        
<div class="col-md-6"><h6 class="code-block-header">Scala</h6><div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">ageSum</span><span class="o">(</span><span class="n">persons</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">Person</span><span class="o">],</span> 
           <span class="n">family</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">persons</span><span class="o">.</span><span class="n">collect</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">Person</span><span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="n">last</span><span class="o">,</span> <span class="n">age</span><span class="o">)</span> <span class="k">if</span> <span class="n">last</span> <span class="o">==</span> <span class="n">family</span> <span class="k">=&gt;</span> 
      <span class="n">age</span>
  <span class="o">}.</span><span class="n">sum</span>
<span class="o">}</span>
<span class="k">val</span> <span class="n">persons</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="nc">Person</span><span class="o">(</span><span class="s">&quot;James&quot;</span><span class="o">,</span> <span class="s">&quot;Bond&quot;</span><span class="o">,</span> <span class="mi">42</span><span class="o">),</span>
  <span class="nc">Person</span><span class="o">(</span><span class="s">&quot;Hillary&quot;</span><span class="o">,</span> <span class="s">&quot;Bond&quot;</span><span class="o">,</span> <span class="mi">35</span><span class="o">),</span>
  <span class="nc">Person</span><span class="o">(</span><span class="s">&quot;James&quot;</span><span class="o">,</span> <span class="s">&quot;Smith&quot;</span><span class="o">,</span> <span class="mi">55</span><span class="o">)</span>
<span class="o">)</span>

<span class="n">ageSum</span><span class="o">(</span><span class="n">persons</span><span class="o">,</span> <span class="s">&quot;Bond&quot;</span><span class="o">)</span> <span class="o">==</span> <span class="mi">77</span></code></pre></div>
</div>
</div>

<p>We could’ve implemented the Scala function using a <code>filter</code> and <code>foldLeft</code>, but it is more understandable using
<code>collect</code> and pattern matching. It would be read as “Collect every person with a last name equaling <code>family</code> and extract
the age of those persons. Then sum up the ages.”</p>

<p>Another good use case for pattern matching is regular expressions (also in ES6!). Let’s extract a date in different
formats.</p>

<div class="row">
<div class="col-md-6"><h6 class="code-block-header">ES6</h6><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">convertToDate</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">YMD</span> <span class="o">=</span> <span class="sr">/(\d{4})-(\d{1,2})-(\d{1,2})/</span>
  <span class="kr">const</span> <span class="nx">MDY</span> <span class="o">=</span> <span class="sr">/(\d{1,2})\/(\d{1,2})\/(\d{4})/</span>
  <span class="kr">const</span> <span class="nx">DMY</span> <span class="o">=</span> <span class="sr">/(\d{1,2})\.(\d{1,2})\.(\d{4})/</span>
  <span class="p">{</span>
    <span class="kr">const</span> <span class="p">[,</span> <span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">day</span><span class="p">]</span> <span class="o">=</span> <span class="nx">YMD</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">year</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span>
      <span class="k">return</span> <span class="p">{</span><span class="nx">year</span><span class="o">:</span> <span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="o">:</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">day</span><span class="o">:</span> <span class="nx">day</span><span class="p">};</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="p">[,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">day</span><span class="p">,</span> <span class="nx">year</span><span class="p">]</span> <span class="o">=</span> 
        <span class="nx">MDY</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">year</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="nx">year</span><span class="o">:</span> <span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="o">:</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">day</span><span class="o">:</span> <span class="nx">day</span><span class="p">};</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">[,</span> <span class="nx">day</span><span class="p">,</span> <span class="nx">month</span><span class="p">,</span> <span class="nx">year</span><span class="p">]</span> <span class="o">=</span> 
          <span class="nx">DMY</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">year</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span>
          <span class="k">return</span> <span class="p">{</span><span class="nx">year</span><span class="o">:</span> <span class="nx">year</span><span class="p">,</span> <span class="nx">month</span><span class="o">:</span> <span class="nx">month</span><span class="p">,</span> 
            <span class="nx">day</span><span class="o">:</span> <span class="nx">day</span><span class="p">};</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">throw</span> <span class="s2">&quot;Invalid date!&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">convertToDate</span><span class="p">(</span><span class="s2">&quot;2015-10-9&quot;</span><span class="p">);</span> <span class="c1">// {year:2015,month:10,day:9}</span>
<span class="nx">convertToDate</span><span class="p">(</span><span class="s2">&quot;10/9/2015&quot;</span><span class="p">);</span> <span class="c1">// {year:2015,month:10,day:9}</span>
<span class="nx">convertToDate</span><span class="p">(</span><span class="s2">&quot;9.10.2015&quot;</span><span class="p">);</span> <span class="c1">// {year:2015,month:10,day:9}</span>
<span class="nx">convertToDate</span><span class="p">(</span><span class="s2">&quot;10 Nov 2015&quot;</span><span class="p">)</span> <span class="c1">// exception</span></code></pre></div>
</div>
        
<div class="col-md-6"><h6 class="code-block-header">Scala</h6><div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">case</span> <span class="k">class</span> <span class="nc">Date</span><span class="o">(</span><span class="n">year</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">month</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">day</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">def</span> <span class="n">convertToDate</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Date</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nc">YMD</span> <span class="k">=</span> <span class="s">&quot;&quot;&quot;(\d{4})-(\d{1,2})-(\d{1,2})&quot;&quot;&quot;</span><span class="o">.</span><span class="n">r</span>
  <span class="k">val</span> <span class="nc">MDY</span> <span class="k">=</span> <span class="s">&quot;&quot;&quot;(\d{1,2})/(\d{1,2})/(\d{4})&quot;&quot;&quot;</span><span class="o">.</span><span class="n">r</span>
  <span class="k">val</span> <span class="nc">DMY</span> <span class="k">=</span> <span class="s">&quot;&quot;&quot;(\d{1,2})\.(\d{1,2})\.(\d{4})&quot;&quot;&quot;</span><span class="o">.</span><span class="n">r</span>
  <span class="n">d</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">YMD</span><span class="o">(</span><span class="n">year</span><span class="o">,</span> <span class="n">month</span><span class="o">,</span> <span class="n">day</span><span class="o">)</span> <span class="k">=&gt;</span> 
      <span class="nc">Date</span><span class="o">(</span><span class="n">year</span><span class="o">.</span><span class="n">toInt</span><span class="o">,</span> <span class="n">month</span><span class="o">.</span><span class="n">toInt</span><span class="o">,</span> <span class="n">day</span><span class="o">.</span><span class="n">toInt</span><span class="o">)</span>
    <span class="k">case</span> <span class="nc">MDY</span><span class="o">(</span><span class="n">month</span><span class="o">,</span> <span class="n">day</span><span class="o">,</span> <span class="n">year</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="nc">Date</span><span class="o">(</span><span class="n">year</span><span class="o">.</span><span class="n">toInt</span><span class="o">,</span> <span class="n">month</span><span class="o">.</span><span class="n">toInt</span><span class="o">,</span> <span class="n">day</span><span class="o">.</span><span class="n">toInt</span><span class="o">)</span>
    <span class="k">case</span> <span class="nc">DMY</span><span class="o">(</span><span class="n">day</span><span class="o">,</span> <span class="n">month</span><span class="o">,</span> <span class="n">year</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="nc">Date</span><span class="o">(</span><span class="n">year</span><span class="o">.</span><span class="n">toInt</span><span class="o">,</span> <span class="n">month</span><span class="o">.</span><span class="n">toInt</span><span class="o">,</span> <span class="n">day</span><span class="o">.</span><span class="n">toInt</span><span class="o">)</span>
    <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> 
      <span class="k">throw</span> <span class="k">new</span> <span class="nc">Exception</span><span class="o">(</span><span class="s">&quot;Invalid date!&quot;</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="n">convertToDate</span><span class="o">(</span><span class="s">&quot;2015-10-9&quot;</span><span class="o">)</span> <span class="c1">// = Date(2015,10,9)</span>
<span class="n">convertToDate</span><span class="o">(</span><span class="s">&quot;10/9/2015&quot;</span><span class="o">)</span> <span class="c1">// = Date(2015,10,9)</span>
<span class="n">convertToDate</span><span class="o">(</span><span class="s">&quot;9.10.2015&quot;</span><span class="o">)</span> <span class="c1">// = Date(2015,10,9)</span>
<span class="n">convertToDate</span><span class="o">(</span><span class="s">&quot;10 Nov 2015&quot;</span><span class="o">)</span> <span class="c1">// exception</span></code></pre></div>
</div>
</div>

<p>Here we use triple-quoted strings that allow us to write regex without escaping special characters. The string is
converted into a <code>Regex</code> object with the <code>.r</code> method. Because regex extracts strings, we need to convert matched groups
to integers ourselves.</p>

<h2 id="implicits">Implicits</h2>

<p>Being type safe is great in Scala, but sometimes the type system can be a bit prohibitive when you want to do something
else, like add methods to existing classes. To allow you to do this in a type safe manner, Scala provides <em>implicits</em>.
You can think of implicits as something that’s available in the scope when you need it, and the compiler can
automatically provide it. For example we can provide a function to automatically convert a JavaScript <code>Date</code> into a
Scala/Java <code>Date</code></p>

<div class="row">
<div class="col-md-9"><h6 class="code-block-header">Scala</h6><div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">scalajs.js</span>

<span class="k">implicit</span> <span class="k">def</span> <span class="n">convertFromJSDate</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">js.Date</span><span class="o">)</span><span class="k">:</span> <span class="kt">java.util.Date</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="nc">Date</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="n">getMilliseconds</span><span class="o">())</span>
<span class="o">}</span>

<span class="k">implicit</span> <span class="k">def</span> <span class="n">convertToJSDate</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">java.util.Date</span><span class="o">)</span><span class="k">:</span> <span class="kt">js.Date</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">new</span> <span class="n">js</span><span class="o">.</span><span class="nc">Date</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="n">getTime</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Person</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">joined</span><span class="k">:</span> <span class="kt">js.Date</span><span class="o">)</span>

<span class="k">val</span> <span class="n">p</span> <span class="k">=</span> <span class="nc">Person</span><span class="o">(</span><span class="s">&quot;James Bond&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="nc">Date</span><span class="o">)</span></code></pre></div>
</div>
</div>

<p>When these implicit conversion functions are in lexical scope, you can use JS and Scala dates interchangeably. Outside
the scope they are not visible and you must use correct types or provide conversion yourself.</p>

<h4 id="implicit-conversions-for-monkey-patching">Implicit conversions for “monkey patching”</h4>

<p>Monkey patching -term became famous among Ruby developers and it has been adopted into JavaScript to describe
a way of extending existing classes with new methods. It has several pitfalls in dynamic languages and is generally
not a recommended practice. Especially dangerous is to patch JavaScript’s host objects like <code>String</code> or <code>DOM.Node</code>. This
technique is, however, commonly used to provide support for new JavaScript functionality missing from older JS engines.
The practice is known as <em>polyfilling</em> or <em>shimming</em>.</p>

<p>In Scala providing extension methods via implicits is <em>perfectly safe</em> and even a <em>recommended</em> practice. Scala
standard library does it all the time. For example did you notice the <code>.r</code> or <code>.toInt</code> functions that were used on
strings in the regex example? Both are extension methods coming from implicit classes.</p>

<p>Let’s use the <code>convertToDate</code> we defined before and add a <code>toDate</code> extension method to <code>String</code> by defining an <em>implicit
class</em>.</p>

<div class="row">
<div class="col-md-6"><h6 class="code-block-header">ES6</h6><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toDate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">convertToDate</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
<span class="s2">&quot;2015-10-09&quot;</span><span class="p">.</span><span class="nx">toDate</span><span class="p">;</span> <span class="c1">// = Date(2015,10,9)</span></code></pre></div>
</div>
        
<div class="col-md-6"><h6 class="code-block-header">Scala</h6><div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">implicit</span> <span class="k">class</span> <span class="nc">StrToDate</span><span class="o">(</span><span class="k">val</span> <span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> 
  <span class="k">extends</span> <span class="nc">AnyVal</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">toDate</span> <span class="k">=</span> <span class="n">convertToDate</span><span class="o">(</span><span class="n">s</span><span class="o">)</span>
<span class="o">}</span>
<span class="s">&quot;2015-10-09&quot;</span><span class="o">.</span><span class="n">toDate</span> <span class="c1">// = Date(2015,10,9)</span></code></pre></div>
</div>
</div>

<p>Note that the JavaScript version modifies the global <code>String</code> class (dangerous!), whereas the Scala version only
introduces a conversion from <code>String</code> to a custom <code>StrToDate</code> class providing an additional method. Implicit classes are
<em>safe</em> because they are lexically scoped, meaning the <code>StrToDate</code> is not available in other parts of the program unless
explicitly imported. The <code>toDate</code> method is not added to the <code>String</code> class in any way, instead the compiler generates
appropriate code to call it when required. Basically <code>"2010-10-09".toDate</code> is converted into <code>new
StrToDate("2010-10-09").toDate</code> which is then inlined/optimized (due to the use of Value Class) to
<code>convertToDate("2010-10-09")</code> at the call site.</p>

<p>Scala IDEs are also smart enough to know what implicit extension methods are in scope and will show them to you next
to the other methods.</p>

<p><img src="/sjs2/assets/img/implicitIDE.png" alt="Extension method in IDE" /></p>

<h2 id="futures">Futures</h2>

<p>Writing asynchronous JavaScript code used to be painful due to the number of callbacks required to handle chained
asynchronous calls. This is affectionately known as <em>callback hell</em>. Then came the various Promise libraries that
alleviated this issue a lot, but were not fully compatible with each other. ES6 standardizes the <code>Promise</code> interface so
that all implementations (ES6’s own included) can happily coexist.</p>

<div class="row">
<div class="col-md-6"><h6 class="code-block-header">ES6</h6>
</div>
        
<div class="col-md-6"><h6 class="code-block-header">Scala</h6>
</div>
</div>

            <div class="spacing"></div>
        </div>
        <div class="col-md-3">
            <nav class="toc" role="navigation">
                
<ul>
    
    <li>
        <a href="/sjs2/doc/">
            
            Introduction
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/quick-start.html">
            
            Quick Start
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/why-scalajs.html">
            
            Why Scala.js?
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/sjs_for_js">
            
            Scala.js for JavaScript developers
            
        </a>
    </li>
    
      
<ul>
    
    <li>
        <a href="/sjs2/doc/sjs_for_js/es6_to_scala_part1.html">
            
            From ES6 to Scala: Basics
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/sjs_for_js/es6_to_scala_part2.html">
            
            From ES6 to Scala: Collections
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/sjs_for_js/es6_to_scala_part3.html">
            
            <b>From ES6 to Scala: Advanced</b>
            
        </a>
    </li>
    
    
</ul>

    
    
    <li>
        <a href="/sjs2/doc/scalajs_for_scaladevs.html">
            
            Scala.js for Scala developers
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/project/">
            
            Project setup
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/interoperability/">
            
            JavaScript interoperability
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/api.html">
            
            Scala.js API
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/semantics.html">
            
            Semantics of Scala.js
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/internals">
            
            Internals
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/doc/faq.html">
            
            FAQ
            
        </a>
    </li>
    
    
</ul>

            </nav>
        </div>
    </div>
</div>

</div>
</div>
<div id="footerwrap">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <h4>LEARN</h4>

                <div class="hline-w"></div>
                <a class="grey-text text-lighten-3" href="/sjs2/doc">Documentation</a><br/>
                <a class="grey-text text-lighten-3" href="/sjs2/tutorial">Tutorial</a><br/>
                <a class="grey-text text-lighten-3" href="/sjs2/doc/faq.html">FAQ</a>
            </div>
            <div class="col-md-4">
                <h4>COMMUNITY</h4>

                <div class="hline-w"></div>
                <a class="grey-text text-lighten-3" href="https://gitter.im/scala-js/scala-js">Gitter chat</a><br/>
                <a class="grey-text text-lighten-3" href="http://stackoverflow.com/questions/tagged/scala.js">Stackoverflow</a><br/>
                <a class="grey-text text-lighten-3" href="https://groups.google.com/forum/?fromgroups#!forum/scala-js">Mailing list</a>
            </div>
            <div class="col-md-4">
                <i class="fa fa-facebook-square"></i>
                <i class="fa fa-twitter-square"></i>
                <i class="fa fa-google-plus-square"></i>
                <i class="fa fa-linkedin-square"></i>
            </div>
        </div>
        <! --/row -->
    </div>
    <! --/container -->
</div><! --/footerwrap -->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/sjs2/assets/js/bootstrap.min.js"></script>
<script src="/sjs2/assets/js/highlight.pack.js"></script>
<script src="/sjs2/assets/js/custom.js"></script>
<script>
hljs.initHighlightingOnLoad();
</script>

</body>
</html>